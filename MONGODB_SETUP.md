# MongoDB Setup Guide for Vercel

## 1. Set up MongoDB Database

### Option A: MongoDB Atlas (Recommended)
1. Go to [MongoDB Atlas](https://www.mongodb.com/atlas)
2. Create a free account
3. Create a new cluster (choose the free M0 tier)
4. Create a database user with read/write permissions
5. Get your connection string

### Option B: Vercel MongoDB Integration
1. Go to your Vercel project dashboard
2. Click on the "Storage" tab
3. Click "Create Database" → "MongoDB"
4. Follow the setup instructions

## 2. Environment Variables

Add these environment variables to your Vercel project:

### Required Variables:
```bash
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/portfolio?retryWrites=true&w=majority
MONGODB_DB=portfolio
```

### For Local Development (.env.local):
```bash
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/portfolio?retryWrites=true&w=majority
MONGODB_DB=portfolio
```

## 3. Database Schema

MongoDB will automatically create the collection when the first document is inserted. The schema is:

```javascript
{
  _id: ObjectId,           // Auto-generated by MongoDB
  email: String,           // User's email address (unique)
  created_at: Date,        // When the email was submitted
  updated_at: Date         // Last updated timestamp
}
```

## 4. Testing

### Local Development:
1. Create `.env.local` with your MongoDB connection string
2. Run `npm run dev`
3. Test the email submission form
4. Check the admin page at `http://localhost:3000/admin`

### Production:
1. Add environment variables to Vercel
2. Deploy your project
3. Test the email form on your live site
4. Visit `/admin` to see submitted emails

## 5. Accessing Submitted Emails

### Method 1: Admin Dashboard
Visit: `https://your-site.vercel.app/admin`

### Method 2: API Endpoint
```bash
curl -X GET https://your-site.vercel.app/api/cv-request
```

### Method 3: MongoDB Atlas Dashboard
1. Go to your MongoDB Atlas cluster
2. Click "Browse Collections"
3. Navigate to your database → cv_requests collection
4. View all submitted emails

### Method 4: MongoDB Compass (Desktop App)
1. Download MongoDB Compass
2. Connect using your connection string
3. Browse the cv_requests collection

## 6. Benefits of MongoDB

✅ **Flexible Schema** - Easy to add new fields later
✅ **Scalable** - Handles high traffic volumes
✅ **Cloud Managed** - No server maintenance required
✅ **Free Tier** - Generous limits for portfolios
✅ **Easy Queries** - Simple JavaScript-like syntax
✅ **Automatic Indexing** - Fast email lookups

## 7. Security Notes

- Never commit your connection string to version control
- Use environment variables for all sensitive data
- Enable IP whitelisting in MongoDB Atlas
- Use strong passwords for database users
- Enable authentication in your MongoDB cluster

## 8. Troubleshooting

### Common Issues:
1. **Connection Error**: Check your MONGODB_URI format
2. **Authentication Failed**: Verify username/password
3. **Network Error**: Check IP whitelist in MongoDB Atlas
4. **Timeout**: Increase connection timeout settings

### Debug Steps:
1. Check Vercel function logs
2. Test connection string in MongoDB Compass
3. Verify environment variables are set correctly
4. Check MongoDB Atlas cluster status
